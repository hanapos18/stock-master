{% extends "base.html" %}
{% block title %}Purchases - StockMaster{% endblock %}
{% block page_title %}Purchases{% endblock %}
{% block content %}
<div class="d-flex justify-content-between mb-3">
  <div class="d-flex gap-2">
    <a href="{{ url_for('purchase.list_purchases') }}" class="btn btn-sm {{ 'btn-primary' if not selected_status else 'btn-outline-primary' }}">All</a>
    {% for s in ['draft','confirmed','received','cancelled'] %}
    <a href="{{ url_for('purchase.list_purchases', status=s) }}" class="btn btn-sm {{ 'btn-primary' if selected_status==s else 'btn-outline-primary' }}">{{ s|capitalize }}</a>{% endfor %}
  </div>
  <a href="{{ url_for('purchase.create_purchase') }}" class="btn btn-primary btn-sm"><i class="bi bi-plus-circle me-1"></i>New Purchase</a>
</div>
<div class="card border-0 shadow-sm"><div class="table-responsive">
  <table class="table table-hover mb-0"><thead class="table-light"><tr>
    <th>Number</th><th>Date</th><th>Supplier</th><th>Store</th><th>Amount</th><th>Status</th><th>Actions</th>
  </tr></thead><tbody>
    {% for p in purchases %}<tr>
      <td><a href="{{ url_for('purchase.view_purchase', purchase_id=p.id) }}">{{ p.purchase_number }}</a></td>
      <td>{{ p.purchase_date }}</td><td>{{ p.supplier_name or '-' }}</td><td>{{ p.store_name }}</td>
      <td class="text-end fw-bold">{{ p.total_amount|fmt_price }}</td>
      <td><span class="badge bg-{{ 'success' if p.status=='received' else 'warning' if p.status=='draft' else 'secondary' }}">{{ p.status }}</span></td>
      <td><a href="{{ url_for('purchase.view_purchase', purchase_id=p.id) }}" class="btn btn-sm btn-outline-primary">View</a></td>
    </tr>{% endfor %}
    {% if not purchases %}<tr><td colspan="7" class="text-center text-muted py-3">No purchases</td></tr>{% endif %}
  </tbody></table>
</div></div>
{% endblock %}
