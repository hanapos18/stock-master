{% extends "base.html" %}
{% block title %}{{ 'Edit' if product else 'New' }} Product - StockMaster{% endblock %}
{% block page_title %}{{ 'Edit' if product else 'New' }} Product{% endblock %}
{% block content %}
<div class="card border-0 shadow-sm" style="max-width:800px;">
  <div class="card-body">
    <form method="post">
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Code *</label>
          <input type="text" name="code" class="form-control" required value="{{ product.code if product else next_code }}">
        </div>
        <div class="col-md-8">
          <label class="form-label">Name *</label>
          <input type="text" name="name" class="form-control" required value="{{ product.name if product else '' }}">
        </div>
        <div class="col-md-4">
          <label class="form-label">Barcode</label>
          <input type="text" name="barcode" class="form-control" value="{{ product.barcode if product else '' }}">
        </div>
        <div class="col-md-4">
          <label class="form-label">Category</label>
          <select name="category_id" class="form-select">
            <option value="">-- None --</option>
            {% for c in categories %}<option value="{{ c.id }}" {{ 'selected' if product and product.category_id == c.id }}>{{ c.name }}</option>{% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label">Supplier</label>
          <select name="supplier_id" class="form-select">
            <option value="">-- None --</option>
            {% for s in suppliers %}<option value="{{ s.id }}" {{ 'selected' if product and product.supplier_id == s.id }}>{{ s.name }}</option>{% endfor %}
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Unit</label>
          <select name="unit" class="form-select">
            {% for u in ['ea','kg','g','L','mL','box','pack','bag','bottle','can','sheet'] %}
            <option value="{{ u }}" {{ 'selected' if product and product.unit == u }}>{{ u }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Buy Price</label>
          <input type="number" name="unit_price" class="form-control" step="0.000001" min="0" value="{{ product.unit_price if product else '0' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Sell Price</label>
          <input type="number" name="sell_price" class="form-control" step="0.000001" min="0" value="{{ product.sell_price if product else '0' }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Min Stock</label>
          <input type="number" name="min_stock" class="form-control" step="0.01" min="0" value="{{ product.min_stock if product else '0' }}">
        </div>
        <div class="col-md-6">
          <label class="form-label">Storage Location</label>
          <input type="text" name="storage_location" class="form-control" placeholder="e.g. A-1-3, Shelf B2, Cold Room #1" value="{{ product.storage_location if product else '' }}">
        </div>
        <div class="col-12">
          <label class="form-label">Description</label>
          <textarea name="description" class="form-control" rows="2">{{ product.description if product else '' }}</textarea>
        </div>
      </div>
      <div class="mt-3">
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="{{ url_for('product.list_products') }}" class="btn btn-outline-secondary ms-2">Cancel</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
